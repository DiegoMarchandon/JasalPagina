"use strict";(()=>{var e={};e.id=43,e.ids=[43],e.modules={535:(e,t,r)=>{r.r(t),r.d(t,{config:()=>p,default:()=>f,routeModule:()=>A});var n={};r.r(n),r.d(n,{createEvento:()=>u,default:()=>d,deleteEvento:()=>E,getAllEventos:()=>c,getEventoById:()=>l,updateEvento:()=>v});var o=r(3480),a=r(8667),i=r(6435),s=r(4900);async function c(){let e;try{e=await s.A.getConnection();let[t]=await e.query("SELECT * FROM evento;");return t}catch(e){throw Error("getAllEventos error al obtener los eventos:"+e.message)}finally{e&&e.release()}}async function l(e){let t;try{t=await s.A.getConnection();let[r]=await t.execute("SELECT * FROM evento WHERE idevento = ?"+[e]);return r}catch(e){throw Error("getEventoById error al obtener el evento:"+e.message)}finally{t&&t.release()}}async function u(e){let t;try{t=await s.A.getConnection();var r=[e.eventofecha,e.eventolugar,e.eventourl];let[n]=await t.execute("INSERT INTO evento (eventofecha, eventolugar, eventourl) VALUES (?,?,?);",[r]);return n.insertId}catch(e){throw Error("createCompra error al crear compra: "+e.message)}finally{t&&t.release()}}async function v(e,t){let r;try{r=await s.A.getConnection();var n="UPDATE evento SET ",o=[],a=0;for(let[e,r]of Object.entries(t))void 0!==r&&(++a>1&&(n+=", "),n+=`${e} = ?`,o.push(r));o.push(e),n+=" WHERE idevento = ? ;";let[i]=await r.execute(n,o);return i.affectedRows}catch(e){throw Error("updateEvento error al actualizar evento: "+e.message)}finally{r&&r.release()}}async function E(e){let t;try{t=await s.A.getConnection();let[r]=await t.execute("DELETE FROM evento WHERE idevento = ?",[e]);return r.affectedRows}catch(e){throw Error("deleteEvento error al eliminar evento: "+e.message)}finally{t&&t.release()}}async function d(e,t){if("GET"===e.method)try{let e=(await c()).map(e=>({...e,eventofecha:new Date(e.eventofecha).toISOString().split("T")[0]}));t.status(200).json({eventos:e})}catch(e){t.status(500).json({message:"Error del servidor ",error:e.message})}}let f=(0,i.M)(n,"default"),p=(0,i.M)(n,"config"),A=new o.PagesAPIRouteModule({definition:{kind:a.A.PAGES_API,page:"/api/requests/evento",pathname:"/api/requests/evento",bundlePath:"",filename:""},userland:n})},3480:(e,t,r)=>{e.exports=r(5600)},4900:(e,t,r)=>{r.d(t,{A:()=>n});let n=require("mysql2/promise").createPool({host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME,waitForConnections:!0,connectionLimit:10,queueLimit:0})},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=t(t.s=535);module.exports=r})();